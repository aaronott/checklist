(function () {
    'use strict';

    function handleDragOver(e) {
      if (e.preventDefault) {
        e.preventDefault();
      }
    }

    function handleDragLeave(e) {
      return false;
    }

    function handleDragEnd(e) {
      return false;
    }

    function handleDragDrop(e) {
      e.preventDefault();

      var file = e.dataTransfer.files[0];
      var files = e.dataTransfer.files;

      console.log(e.toElement.id);
      var section = e.toElement.id;

      var copyFileSync = function(srcFile, destFile) {
        var content = fs.readFileSync(srcFile);
        fs.writeFileSync(destFile, content);
      }

      for (var f in files) {
        console.log('File you dragged here is', files[f].path);
        if (files[f].path != undefined) {
          copyFileSync(files[f].path, "/tmp/" + section + "-" + f);

        }
        console.log('f: ' + f)
      }

      return false;
    }

    function setDropZones() {
      var dropZones = document.querySelectorAll('.file-drop-zone');

      [].forEach.call(dropZones, function(zone){
        zone.addEventListener('dragover', handleDragOver, false);
        zone.addEventListener('dragleave', handleDragLeave, false);
        zone.addEventListener('dragend', handleDragEnd, false);
        zone.addEventListener('drop', handleDragDrop, false);
      });
    }

    setDropZones();

    document.getElementById('container').addEventListener('load', setDropZones, false);
    document.getElementById('container').addEventListener('containerLoad', setDropZones, false);

}());
